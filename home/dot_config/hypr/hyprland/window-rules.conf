
# ================================
# SYSTEM BEHAVIOR
# ================================

# Idle inhibition - prevent sleep during media playback
windowrule = idleinhibit focus, class:^(celluloid|mpv|vlc|[Ss]potify)$
windowrule = idleinhibit fullscreen, class:^(LibreWolf|floorp|Brave|firefox|chromium|zen|vivaldi)$

# Tearing optimization for games and high-performance apps
windowrule = immediate, title:.*\.exe
windowrule = immediate, title:.*minecraft.*
windowrule = immediate, class:^(steam_app)$

# Visual optimizations
windowrule = noshadow, floating:0
windowrule = center 1, floating:1, xwayland:0
windowrule = opaque, class:^(foot|equibop|imv|swappy|brave-browser|mpv|vlc|celluloid)$

# Good practices
windowrule = nofocus, class:^$, title:^$, xwayland:1, floating:1, fullscreen:0, pinned:0
windowrule = suppressevent maximize, class:.*

# ================================
# PICTURE-IN-PICTURE
# ================================

$pip_title = title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$

windowrule = float, $pip_title
windowrule = keepaspectratio, $pip_title
windowrule = move 73% 72%, $pip_title
windowrule = size 25%, $pip_title
windowrule = pin, $pip_title

# ================================
# FILE DIALOGS
# ================================

# Large file dialogs (55% screen)
$dialog_large = title:^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Library|File Upload|.*Save File.*|.*Save Folder.*|.*Save Image.*|.*Open As.*|.*Open Network Stream.*|.*Choose Files.*|.*Downloads -.*|File Operation Progress|Downloads.*|Choose Directory|Where do you want to save the.*)$

windowrule = float, $dialog_large
windowrule = center, $dialog_large
windowrule = size 55% 55%, $dialog_large

# Small confirmation dialogs (20% screen)
$dialog_small = title:^(.*File Already Exists.*|.*Confirm to replace files.*|.*Confirm to delete files.*|Rename.*|Delete.*|Move to Trash.*|.*Confirmation.*|.*Warning.*|.*Error.*)$

windowrule = float, $dialog_small
windowrule = center, $dialog_small
windowrule = size 20% 15%, $dialog_small

# ================================
# FLOATING WINDOW SIZE CATEGORIES
# ================================

# Large floating windows (70% screen)
$float_large = class:^(center-float-large|qimgv|nvidia-settings|localsend|org.gnome.Evince)$

windowrule = float, $float_large
windowrule = size 70% 70%, $float_large
windowrule = center 1, $float_large

# Medium floating windows (50% screen)
$float_medium = class:^(center-float|xdg-desktop-portal-gtk|selectdefaultapplication)$

windowrule = float, $float_medium
windowrule = size 50% 50%, $float_medium
windowrule = center 1, $float_medium

# Small floating windows (30-40% screen)
$float_small = class:^(center-float-mini|galculator|ytdlp-gui|udiskie|Calculator)$
$float_small_title = title:^(Pick a Font)$

windowrule = float, $float_small
windowrule = float, $float_small_title
windowrule = size 30% 40%, $float_small
windowrule = size 40% 40%, $float_small_title
windowrule = center 1, $float_small

# ================================
# MEDIA PLAYERS
# ================================

# VLC Media Player
$vlc = class:^(vlc)$
$vlc_dialogs = title:^(Select one or more files to open|Simple Preferences|Adjustments and Effects|Current Media Information|Open URL|Open Media|Save playlist as\.\.\.|Open Directory) — VLC media player$

windowrule = float, $vlc
windowrule = center 1, $vlc
windowrule = size 50% 50%, $vlc_dialogs
windowrule = size 70% 70%, $vlc, title:^(.*VLC media player)$

# Other media players (70% screen)
$media_large = class:^(mpv|celluloid|com.github.rafostar.Clapper)$

windowrule = float, $media_large
windowrule = size 70% 70%, $media_large
windowrule = center 1, $media_large

# MPV playlist dialog
windowrule = float, class:^(org.kde.kdialog)$, title:^(mpv playlist|Select Files)$
windowrule = size 50% 50%, class:^(org.kde.kdialog)$, title:^(Select Files)$

# Keep YouTube videos opaque
windowrule = opacity 1.0 override, title:.*(YouTube).*

# ================================
# AUTHENTICATION & SECURITY
# ================================

# Polkit authentication dialogs
$polkit = class:^(polkit-gnome-authentication-agent-1|polkit-kde-authentication-agent-1|hyprpolkitagent)$

windowrule = float, $polkit
windowrule = pin, $polkit
windowrule = stayfocused, $polkit

# Disable screensharing for sensitive apps
windowrule = noscreenshare, class:^(discord|vesktop|org.telegram.desktop|Signal|WhatsApp|Bitwarden)$
windowrule = noscreenshare, class:^(polkit-.*|pinentry.*)$, title:^(Authenticate)$

# Password managers
$bitwarden = class:^(Bitwarden)$
windowrule = float, $bitwarden
windowrule = size 60% 60%, $bitwarden
windowrule = center 1, $bitwarden
windowrule = noscreenshare, $bitwarden

# Browser extension popups (Bitwarden)
$bitwarden_extension = class:^(brave-nngceckbapebfimnlniiiahkandclblb-Default)$
windowrule = float, $bitwarden_extension
windowrule = size 30% 60%, $bitwarden_extension
windowrule = noscreenshare, $bitwarden_extension

# 1Password
$onepassword = class:^(1Password)$
windowrule = float, $onepassword
windowrule = size 60% 60%, $onepassword
windowrule = center 1, $onepassword

# Brave browser popups
$brave_popups = class:^(brave-browser)$, initialTitle:^(Untitled - Brave|PayPal - Brave)$
windowrule = float, $brave_popups
windowrule = size 30% 70%, $brave_popups
windowrule = center 1, $brave_popups

windowrule = float, initialTitle:^(Task Manager - Brave)$
windowrule = size 70% 70%, initialTitle:^(Task Manager - Brave)$


# ================================
# APPLICATION-SPECIFIC RULES
# ================================

# Audio control scratchpad
$audio_scratchpad = class:^(pavucontrol|blueman-manager|pwvucontrol)$
windowrule = float, $audio_scratchpad
windowrule = center 1, $audio_scratchpad
windowrule = size 40% 40%, $audio_scratchpad

# Nautilus file manager
$nautilus = class:^(org.gnome.Nautilus)$, initialTitle:^(Loading…|Home)$
windowrule = float, $nautilus
windowrule = size 80% 80%, $nautilus
windowrule = center 1, $nautilus

# XWayland video bridge (screen sharing)
$videobridge = class:^(xwaylandvideobridge)$
windowrule = opacity 0.0 override 0.0 override, $videobridge
windowrule = noanim, $videobridge
windowrule = noblur, $videobridge
windowrule = noinitialfocus, $videobridge
windowrule = maxsize 1 1, $videobridge

# Android screen mirroring (scrcpy)
$scrcpy = class:^(scrcpy)$
windowrule = float, $scrcpy
windowrule = center 1, $scrcpy

# Torrent client (qBittorrent)
$qbittorrent = class:^(org.qbittorrent.qBittorrent)$
windowrule = float, $qbittorrent
windowrule = size 70% 70%, $qbittorrent, title:^(qBittorrent.*)$
windowrule = size 40% 90%, $qbittorrent, title:^(Preview selection)$

# Bluetooth manager (Overskride)
$overskride = class:^(Overskride)$
windowrule = float, $overskride
windowrule = size 30% 80%, $overskride

# Partition manager (GParted)
$gparted = title:^(.*GParted)$
windowrule = float, $gparted
windowrule = size 60% 55%, $gparted
windowrule = center 1, $gparted

# Btrfs management
$btrfs_assistant = class:^(btrfs-assistant)$, initialTitle:^(Btrfs Assistant|Diff Viewer)$
windowrule = float, $btrfs_assistant
windowrule = size 70% 70%, $btrfs_assistant
windowrule = center 1, $btrfs_assistant

# Clipboard manager (Clipse)
$clipse = class:^(clipse-gui)$
windowrule = float, $clipse
windowrule = size 35% 45%, $clipse
windowrule = center 1, $clipse
windowrule = stayfocused, $clipse

# Image viewer (imv)
$imv = class:^(imv)$
windowrule = float, $imv
windowrule = opaque, $imv
windowrule = size 60% 60%, $imv
windowrule = center 1, $imv

# Wallpaper managers
$waypaper = class:^(waypaper|org.Waytrogen.Waytrogen)$
windowrule = float, $waypaper
windowrule = float, title:^(SWWW Advanced Image Settings)$
windowrule = size 55% 70%, $waypaper
windowrule = center 1, $waypaper

# System monitor (Mission Center)
$missioncenter = class:^(io.missioncenter.MissionCenter)$
windowrule = float, $missioncenter
windowrule = size 75% 75%, $missioncenter
windowrule = center 1, $missioncenter

# Theming applications
$theming = class:^(kvantummanager|qt5ct|qt6ct|nwg-look|org.kde.ark)$
windowrule = float, $theming

# Floating terminal
$float_term = class:^(FloatingTerm)$
windowrule = float, $float_term
windowrule = size 80% 80%, $float_term
windowrule = center 1, $float_term

# Miscellaneous floating apps
windowrule = float, title:^(About Mozilla Firefox)$
windowrule = float, class:^(firefox)$, title:^(Library)$
windowrule = float, class:^(blueman-manager|nm-applet|nm-connection-editor|signal|app.drey.Warp|net.davidotek.pupgui2|yad)$
windowrule = float, class:^(io.github.alainm23.planify|io.gitlab.theevilskeleton.Upscaler)$
windowrule = float, class:^(com.github.unrud.VideoDownloader|io.gitlab.adhami3310.Impression)$

# XWayland popups
windowrule = nodim, xwayland:1, title:^(win[0-9]+)$
windowrule = noshadow, xwayland:1, title:^(win[0-9]+)$
windowrule = rounding 10, xwayland:1, title:^(win[0-9]+)$

# ================================
# ANIMATIONS
# ================================

windowrule = animation slide, title:^(.*cava.*)$
windowrule = animation popin, class:^(wleave)$

# ================================
# LAYER RULES
# ================================

# Rofi launcher
layerrule = animation popin, rofi
layerrule = blur, rofi
layerrule = ignorezero, rofi
layerrule = ignorealpha 0.57, rofi

# Utility layers
layerrule = animation fade, ^(hyprpicker|logout_dialog|selection)

# Quickshell
layerrule = blur, ^(quickshell.*|dms.*)
layerrule = ignorealpha 0.65, ^(quickshell.*|dms.*)
layerrule = blurpopups, ^(quickshell.*|dms.*)

# ================================
# WORKSPACE RULES
# ================================

# Smart gaps - remove gaps for tiled windows
workspace = w[tv1], gapsout:0, gapsin:0
windowrule = bordersize 2, floating:0, onworkspace:w[tv1]

# Special workspaces
workspace = special:exposed, gapsout:60, gapsin:30, bordersize:5, border:true, shadow:false
