
# ================================
# SYSTEM BEHAVIOR
# ================================

# Idle inhibition - prevent sleep during media playback
windowrule {
  name = idle-inhibit-media
  idle_inhibit = focus
  match:class = ^(celluloid|mpv|vlc|[Ss]potify)$
}

windowrule {
  name = idle-inhibit-fullscreen-browsers
  idle_inhibit = fullscreen
  match:class = ^(LibreWolf|floorp|Brave|firefox|chromium|zen|vivaldi)$
}


# Tearing optimization for games and high-performance apps
windowrule {
  name = immediate-wine-exe
  immediate = on
  match:title = .*\.exe
}

windowrule {
  name = immediate-minecraft
  immediate = on
  match:title = .*minecraft.*
}

windowrule {
  name = immediate-steam-app
  immediate = on
  match:class = ^(steam_app)$
}


# Visual optimizations
windowrule {
  name = no-shadow-tiled
  no_shadow = on
  match:float = 0
}

windowrule {
  name = center-float-wayland
  center = 1
  match:float = 1
  match:xwayland = 0
}

windowrule {
  name = opaque-media-and-tools
  opaque = on
  match:class = ^(foot|equibop|imv|swappy|brave-browser|mpv|vlc|celluloid)$
}


# Good practices
windowrule {
  name = no-focus-ghost-xwayland
  no_focus = on
  match:class = ^$
  match:title = ^$
  match:xwayland = 1
  match:float = 1
  match:fullscreen = 0
  match:pin = 0
}

windowrule {
  name = suppress-maximize
  suppress_event = maximize
  match:class = .*
}


# ================================
# PICTURE-IN-PICTURE
# ================================


windowrule {
  name = picture-in-picture
  float = on
  keep_aspect_ratio = on
  move = ((monitor_w*0.73)) ((monitor_h*0.72))
  size = (monitor_w*0.25)
  pin = on
  match:title = ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
}

# ================================
# FILE DIALOGS
# ================================

# Large file dialogs (55% screen)
windowrule {
  name = file-dialog-large
  float = on
  center = on
  size = (monitor_w*0.55) (monitor_h*0.55)
  match:title = ^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Library|File Upload|.*Save File.*|.*Save Folder.*|.*Save Image.*|.*Open As.*|.*Open Network Stream.*|.*Choose Files.*|.*Downloads -.*|File Operation Progress|Downloads.*|Choose Directory|Where do you want to save the.*)$

}

windowrule {
  name = dms
  float = on
  center = on
  size = (monitor_w*0.75) (monitor_h*0.85)
  match:title = ^(Settings|System Monitor)
}


# Small confirmation dialogs (20% screen)

windowrule {
  name = confirmation-dialog-small
  float = on
  center = on
  size = (monitor_w*0.2) (monitor_h*0.15)
  match:title = ^(.*File Already Exists.*|.*Confirm to replace files.*|.*Confirm to delete files.*|Rename.*|Delete.*|Move to Trash.*|.*Confirmation.*|.*Warning.*|.*Error.*)$

}


# ================================
# FLOATING WINDOW SIZE CATEGORIES
# ================================

# Large floating windows (70% screen)

windowrule {
  name = float-large
  float = on
  size = (monitor_w*0.7) (monitor_h*0.7)
  center = 1
  match:class = ^(center-float-large|qimgv|nvidia-settings|localsend|org.gnome.Evince)$

}


# Medium floating windows (50% screen)

windowrule {
  name = float-medium
  float = on
  size = (monitor_w*0.5) (monitor_h*0.5)
  center = 1
  match:class = ^(center-float|xdg-desktop-portal-gtk|selectdefaultapplication)$
}


# Small floating windows (30-40% screen)

windowrule {
  name = float-small
  float = on
  size = (monitor_w*0.3) (monitor_h*0.4)
  center = 1
  match:class = ^(center-float-mini|galculator|ytdlp-gui|udiskie|Calculator)$
}

windowrule {
  name = float-font-picker
  float = on
  size = (monitor_w*0.4) (monitor_h*0.4)
  match:title = ^(Pick a Font)$
}


# ================================
# MEDIA PLAYERS
# ================================

# VLC Media Player

windowrule {
  name = vlc-main-float
  float = on
  center = 1
  match:class = ^(vlc)$
}

windowrule {
  name = vlc-dialogs
  size = (monitor_w*0.5) (monitor_h*0.5)
  match:title = ^(Select one or more files to open|Simple Preferences|Adjustments and Effects|Current Media Information|Open URL|Open Media|Save playlist as\.\.\.|Open Directory) — VLC media player$
}

windowrule {
  name = vlc-main-size
  size = (monitor_w*0.7) (monitor_h*0.7)
  match:title = ^(.*VLC media player)$
  match:class = ^(vlc)$
}


# Other media players (70% screen)

windowrule {
  name = media-players-large
  float = on
  size = (monitor_w*0.7) (monitor_h*0.7)
  center = 1
  match:class = ^(mpv|celluloid|com.github.rafostar.Clapper)$
}


# MPV playlist dialog
windowrule {
  name = mpv-playlist-float
  float = on
  match:class = ^(org.kde.kdialog)$
  match:title = ^(mpv playlist|Select Files)$
}

windowrule {
  name = mpv-playlist-size
  size = (monitor_w*0.5) (monitor_h*0.5)
  match:class = ^(org.kde.kdialog)$
  match:title = ^(Select Files)$
}


# Keep YouTube videos opaque
windowrule {
  name = youtube-opaque
  opacity = 1.0 override
  match:title = .*(YouTube).*
}


# ================================
# AUTHENTICATION & SECURITY
# ================================

# Polkit authentication dialogs

windowrule {
  name = polkit-auth-dialog
  float = on
  pin = on
  stay_focused = on
  match:class = ^(polkit-gnome-authentication-agent-1|polkit-kde-authentication-agent-1|hyprpolkitagent)$
}


# Disable screensharing for sensitive apps
windowrule {
  name = no-screenshare-messengers
  no_screen_share = on
  match:class = ^(discord|vesktop|org.telegram.desktop|Signal|WhatsApp|Bitwarden)$
}

windowrule {
  name = no-screenshare-pinentry
  no_screen_share = on
  match:class = ^(polkit-.*|pinentry.*)$
  match:title = ^(Authenticate)$
}


# Password managers
windowrule {
  name = bitwarden-float
  float = on
  size = (monitor_w*0.6) (monitor_h*0.6)
  center = 1
  no_screen_share = on
  match:class = ^(Bitwarden)$
}


# Browser extension popups (Bitwarden)
windowrule {
  name = bitwarden-extension-popup
  float = on
  size = (monitor_w*0.3) (monitor_h*0.6)
  no_screen_share = on
  match:class = ^(brave-nngceckbapebfimnlniiiahkandclblb-Default)$
}


# 1Password
windowrule {
  name = onepassword-float
  float = on
  size = (monitor_w*0.6) (monitor_h*0.6)
  center = 1
  match:class = ^(1Password)$
}


# Brave browser popups
windowrule {
  name = brave-popups
  float = on
  size = (monitor_w*0.3) (monitor_h*0.7)
  center = 1
  match:class = ^(brave-browser)$
  match:initial_title = ^(Untitled - Brave|PayPal - Brave)$
}


windowrule {
  name = brave-task-manager
  float = on
  size = (monitor_w*0.7) (monitor_h*0.7)
  match:initial_title = ^(Task Manager - Brave)$
}



# ================================
# APPLICATION-SPECIFIC RULES
# ================================

# Audio control scratchpad
windowrule {
  name = audio-scratchpad
  float = on
  center = 1
  size = (monitor_w*0.4) (monitor_h*0.4)
  match:class = ^(pavucontrol|blueman-manager|pwvucontrol)$
}


# Nautilus file manager
windowrule {
  name = nautilus-float
  float = on
  size = (monitor_w*0.8) (monitor_h*0.8)
  center = 1
  match:class = ^(org.gnome.Nautilus)$
  match:initial_title = ^(Loading…|Home)$
}


# XWayland video bridge (screen sharing)
windowrule {
  name = xwayland-video-bridge
  opacity = 0.0 override 0.0 override
  no_anim = on
  no_blur = on
  no_initial_focus = on
  max_size = 1 1
  match:class = ^(xwaylandvideobridge)$
}

# Hyprland Share Picker
windowrule {
    name = hyprland-share-picker
    match:class = (hyprland-share-picker)
    float = true
    pin = true
    center = true
    size = 600 400
}


# Android screen mirroring (scrcpy)
windowrule {
  name = scrcpy-float
  float = on
  center = 1
  match:class = ^(scrcpy)$
}


# Torrent client (qBittorrent)
windowrule {
  name = qbittorrent-float
  float = on
  match:class = ^(org.qbittorrent.qBittorrent)$
}

windowrule {
  name = qbittorrent-main-size
  size = (monitor_w*0.7) (monitor_h*0.7)
  match:title = ^(qBittorrent.*)$
  match:class = ^(org.qbittorrent.qBittorrent)$
}

windowrule {
  name = qbittorrent-preview-size
  size = (monitor_w*0.4) (monitor_h*0.9)
  match:title = ^(Preview selection)$
  match:class = ^(org.qbittorrent.qBittorrent)$
}


# Bluetooth manager (Overskride)
windowrule {
  name = overskride-float
  float = on
  size = (monitor_w*0.3) (monitor_h*0.8)
  match:class = ^(Overskride)$
}


# Partition manager (GParted)
windowrule {
  name = gparted-float
  float = on
  size = (monitor_w*0.6) (monitor_h*0.55)
  center = 1
  match:title = ^(.*GParted)$
}


# Btrfs management
windowrule {
  name = btrfs-assistant-float
  float = on
  size = (monitor_w*0.7) (monitor_h*0.7)
  center = 1
  match:class = ^(btrfs-assistant)$
  match:initial_title = ^(Btrfs Assistant|Diff Viewer)$
}


# Clipboard manager (Clipse)
windowrule {
  name = clipse-float
  float = on
  size = (monitor_w*0.35) (monitor_h*0.45)
  center = 1
  stay_focused = on
  match:class = ^(clipse-gui)$
}


# Image viewer (imv)
windowrule {
  name = imv-float
  float = on
  opaque = on
  size = (monitor_w*0.6) (monitor_h*0.6)
  center = 1
  match:class = ^(imv)$
}


# Wallpaper managers
windowrule {
  name = wallpaper-manager-float
  float = on
  size = (monitor_w*0.55) (monitor_h*0.7)
  center = 1
  match:class = ^(waypaper|org.Waytrogen.Waytrogen)$
}

windowrule {
  name = swww-advanced-float
  float = on
  match:title = ^(SWWW Advanced Image Settings)$
}


# System monitor (Mission Center)
windowrule {
  name = missioncenter-float
  float = on
  size = (monitor_w*0.75) (monitor_h*0.75)
  center = 1
  match:class = ^(io.missioncenter.MissionCenter)$
}


# Theming applications
windowrule {
  name = theming-apps-float
  float = on
  match:class = ^(kvantummanager|qt5ct|qt6ct|nwg-look|org.kde.ark)$
}


# Floating terminal
windowrule {
  name = floating-terminal
  float = on
  size = (monitor_w*0.8) (monitor_h*0.8)
  center = 1
  match:class = ^(FloatingTerm)$
}


# Miscellaneous floating apps
windowrule {
  name = firefox-about-float
  float = on
  match:title = ^(About Mozilla Firefox)$
}

windowrule {
  name = firefox-library-float
  float = on
  match:class = ^(firefox)$
  match:title = ^(Library)$
}

windowrule {
  name = misc-float-network-tools
  float = on
  match:class = ^(blueman-manager|nm-applet|nm-connection-editor|signal|app.drey.Warp|net.davidotek.pupgui2|yad)$
}

windowrule {
  name = misc-float-planify-upscaler
  float = on
  match:class = ^(io.github.alainm23.planify|io.gitlab.theevilskeleton.Upscaler)$
}

windowrule {
  name = misc-float-video-tools
  float = on
  match:class = ^(com.github.unrud.VideoDownloader|io.gitlab.adhami3310.Impression)$
}


# XWayland popups
windowrule {
  name = xwayland-popups
  no_dim = on
  no_shadow = on
  rounding = 10
  match:xwayland = 1
  match:title = ^(win[0-9]+)$
}


# ================================
# ANIMATIONS
# ================================

windowrule {
  name = cava-slide
  animation = slide
  match:title = ^(.*cava.*)$
}

windowrule {
  name = wleave-popin
  animation = popin
  match:class = ^(wleave)$
}


# ================================
# LAYER RULES
# ================================


# Utility layers
layerrule {
  name = utility-layer-fade
  animation = fade
  match:namespace = ^(hyprpicker|logout_dialog|selection)
}


# Quickshell
layerrule {
  name = quickshell-blur
  blur = on
  ignore_alpha = 0.65
  blur_popups = on
  match:namespace = ^(quickshell.*|dms.*)
}


# ================================
# WORKSPACE RULES
# ================================

# Smart gaps - remove gaps for tiled windows
workspace = w[tv1], gapsout:0, gapsin:0
windowrule {
  name = workspace-tv1-border
  border_size = 2
  match:float = 0
  match:workspace = w[tv1]
}


# Special workspaces
workspace = special:exposed, gapsout:60, gapsin:30, bordersize:5, border:true, shadow:false
